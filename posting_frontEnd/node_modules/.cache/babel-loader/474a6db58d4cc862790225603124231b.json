{"ast":null,"code":"import _asyncToGenerator from \"/Users/anders/Desktop/work/Vue/Posting-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport { Axios, HTTP } from \"@/services/axios.js\";\nimport moment from 'moment';\n\nvar RegisterUser = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(data) {\n    var result;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            result = null;\n            _context.prev = 1;\n            _context.next = 4;\n            return Axios.post('users', data).then(function (response) {\n              result = response.data;\n            });\n\n          case 4:\n            return _context.abrupt(\"return\", result);\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](1);\n            console.log(_context.t0);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[1, 7]]);\n  }));\n\n  return function RegisterUser(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar LoginUser = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(data) {\n    var result;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            result = null;\n            _context2.prev = 1;\n            _context2.next = 4;\n            return Axios.post('auth/login', data).then(function (response) {\n              result = response.data;\n            });\n\n          case 4:\n            return _context2.abrupt(\"return\", result);\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](1);\n            console.log(_context2.t0);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[1, 7]]);\n  }));\n\n  return function LoginUser(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar SetUser = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(id, token) {\n    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return HTTP.get('/users/' + id, {\n              headers: {\n                'Authorization': 'Bearer ' + token\n              }\n            }).then(function (response) {\n              localStorage.setItem('user', JSON.stringify(response.data));\n            }).catch(function (e) {\n              console.log(e);\n            });\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function SetUser(_x3, _x4) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nvar GetAccessInfo = function GetAccessInfo() {\n  var accessInfo = localStorage.getItem('accessInfo');\n\n  if (accessInfo != 'undefined' && accessInfo != null) {\n    accessInfo = JSON.parse(accessInfo);\n    var d = parseInt(accessInfo.exp.split(' ')[0].split('-')[0]);\n    var m = parseInt(accessInfo.exp.split(' ')[0].split('-')[2]);\n    var y = parseInt(accessInfo.exp.split(' ')[0].split('-')[3]);\n    var h = parseInt(accessInfo.exp.split(' ')[1].split(':')[0]);\n    var mm = parseInt(accessInfo.exp.split(' ')[1].split(':')[1]);\n    var exp = new Date(y, m, d, h, mm);\n    var now = new Date();\n    console.log(now, 'exp :', exp);\n    console.log('comprare date', now < exp);\n\n    if (accessInfo.token != '' && now < exp) {\n      SetUser(accessInfo.user_id, accessInfo.token);\n      return true;\n    }\n\n    if (accessInfo.token == '' || now > exp) {\n      alert('qua');\n      reject();\n      return false;\n    }\n  } else {\n    reject();\n    return false;\n  }\n};\n\nvar reject = function reject() {\n  localStorage.removeItem('accessInfo');\n  localStorage.removeItem('user');\n  localStorage.removeItem('posts');\n};\n\nvar GetUser = function GetUser() {\n  var user = localStorage.getItem('user');\n\n  if (user !== 'undefined' && user != null) {\n    return JSON.parse(user);\n  }\n\n  return null;\n};\n\nexport { RegisterUser, LoginUser, GetUser, GetAccessInfo };","map":{"version":3,"sources":["/Users/anders/Desktop/work/Vue/Posting-app/src/services/UsersServices.js"],"names":["Axios","HTTP","moment","RegisterUser","data","result","post","then","response","console","log","LoginUser","SetUser","id","token","get","headers","localStorage","setItem","JSON","stringify","catch","e","GetAccessInfo","accessInfo","getItem","parse","d","parseInt","exp","split","m","y","h","mm","Date","now","user_id","alert","reject","removeItem","GetUser","user"],"mappings":"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","sourcesContent":["import {\n  Axios,\n  HTTP\n} from \"@/services/axios.js\"\nimport moment from 'moment';\n\n\nconst RegisterUser = async function (data) {\n  let result = null;\n  try {\n    await Axios.post('users', data)\n      .then(response => {\n        result = response.data\n      })\n    return result\n  } catch (error) {\n    console.log(error)\n  }\n}\nconst LoginUser = async function (data) {\n  let result = null\n  try {\n    await Axios.post('auth/login', data)\n      .then(response => {\n        result = response.data\n      })\n    return result\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nconst SetUser = async function (id, token) {\n  await HTTP.get('/users/' + id, {\n      headers: {\n        'Authorization': 'Bearer ' + token\n      }\n    })\n    .then(response => {\n      localStorage.setItem('user', JSON.stringify(response.data))\n    })\n    .catch(e => {\n      console.log(e)\n    })\n}\n\n\nconst GetAccessInfo = function () {\n  let accessInfo = localStorage.getItem('accessInfo')\n  if (accessInfo != 'undefined' && accessInfo != null) {\n    accessInfo = JSON.parse(accessInfo)\n    let d=parseInt(accessInfo.exp.split(' ')[0].split('-')[0])\n    let m=parseInt(accessInfo.exp.split(' ')[0].split('-')[2])\n    let y=parseInt(accessInfo.exp.split(' ')[0].split('-')[3])\n    let h=parseInt( accessInfo.exp.split(' ')[1].split(':')[0])\n    let mm=parseInt( accessInfo.exp.split(' ')[1].split(':')[1])\n\n    let exp =  new Date(y, m, d, h, mm)\n    let now = new Date()\n    console.log(now , 'exp :',  exp)\n    console.log('comprare date',now < exp)\n\n    if (accessInfo.token != '' && now < exp) {\n      SetUser(accessInfo.user_id, accessInfo.token)\n      return true\n    }\n\n    if(accessInfo.token == '' || now > exp){\n      alert('qua')\n      reject()\n      return false\n    }\n    \n  }\n  else{\n    reject()\n    return false\n  }\n}\n\nconst reject = function () {\n  localStorage.removeItem('accessInfo')\n  localStorage.removeItem('user')\n  localStorage.removeItem('posts')\n}\n\n\nconst GetUser = function () {\n  let user = localStorage.getItem('user')\n  if (user !== 'undefined' && user != null) {\n    return JSON.parse(user)\n  }\n  return null\n}\n\n\n\nexport {\n  RegisterUser,\n  LoginUser,\n  GetUser,\n  GetAccessInfo\n}"]},"metadata":{},"sourceType":"module"}