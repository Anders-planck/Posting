{"ast":null,"code":"import _asyncToGenerator from \"/Users/anders/Desktop/work/Vue/Posting-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"regenerator-runtime/runtime.js\";\nimport { Axios } from '@/services/axios.js';\n\nvar SetUser = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(id, token) {\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return Axios.get('/users/' + id, {\n              headers: {\n                'Authorization': 'Bearer ' + token\n              }\n            }).then(function (response) {\n              localStorage.setItem('user', JSON.stringify(response.data));\n            }).catch(function (e) {\n              console.log(e);\n            });\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function SetUser(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar GetAccessInfo = function GetAccessInfo() {\n  var accessInfo = localStorage.getItem('accessInfo');\n\n  if (accessInfo != 'undefined' && accessInfo != null) {\n    accessInfo = JSON.parse(accessInfo);\n    var exp = new Date(accessInfo.exp);\n    var now = new Date();\n\n    if (accessInfo.token != '' && exp < now) {\n      var user = localStorage.getItem('user');\n\n      if (user == 'undefined' || user == null) {\n        SetUser(accessInfo.user_id, accessInfo.token);\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n};\n\nvar GetUser = function GetUser() {\n  var user = localStorage.getItem('user');\n\n  if (user !== 'undefined' && user != null) {\n    return JSON.parse(user);\n  }\n\n  return null;\n};\n\nexport default {\n  state: {\n    logged: GetAccessInfo(),\n    currentUser: GetUser(),\n    users: []\n  },\n  mutations: {\n    Register: function () {\n      var _Register = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(state, payload) {\n        var result;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return users.RegisterUser(payload);\n\n              case 2:\n                result = _context2.sent;\n                state.currentUser = result;\n                localStorage.setItem('user', JSON.stringify(state.currentUser));\n                router.push('login');\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function Register(_x3, _x4) {\n        return _Register.apply(this, arguments);\n      }\n\n      return Register;\n    }(),\n    Login: function () {\n      var _Login = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(state, payload) {\n        var result;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return users.LoginUser(payload);\n\n              case 2:\n                result = _context3.sent;\n                console.log(result);\n                localStorage.setItem('accessInfo', JSON.stringify(result));\n                state.logged = GetAccessInfo();\n                router.push('/');\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function Login(_x5, _x6) {\n        return _Login.apply(this, arguments);\n      }\n\n      return Login;\n    }()\n  },\n  actions: {},\n  getters: {\n    getLogged: function getLogged(state) {\n      return state.logged;\n    },\n    getCurrentUser: function getCurrentUser(state) {\n      return state.currentUser;\n    },\n    getStatus: function getStatus(state) {\n      return state.status;\n    }\n  }\n};","map":{"version":3,"sources":["/Users/anders/Desktop/work/Vue/Posting-app/src/store/module/users.js"],"names":["Axios","SetUser","id","token","get","headers","then","response","localStorage","setItem","JSON","stringify","data","catch","e","console","log","GetAccessInfo","accessInfo","getItem","parse","exp","Date","now","user","user_id","GetUser","state","logged","currentUser","users","mutations","Register","payload","RegisterUser","result","router","push","Login","LoginUser","actions","getters","getLogged","getCurrentUser","getStatus","status"],"mappings":"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","sourcesContent":["import { Axios} from '@/services/axios.js'\n\nconst SetUser =  async function (id ,token) {\n    await  Axios.get('/users/' + id, {\n      headers: {\n        'Authorization': 'Bearer ' + token\n      }\n    })\n    .then(response => {\n      localStorage.setItem('user', JSON.stringify(response.data))\n    })\n    .catch( e => {console.log(e)})\n}\n  \nconst GetAccessInfo = function () {\n    let accessInfo = localStorage.getItem('accessInfo')\n    if (accessInfo!='undefined' && accessInfo!=null) {\n      accessInfo = JSON.parse(accessInfo)\n      let exp = new Date(accessInfo.exp)\n      let now = new Date()\n      if (accessInfo.token != '' && exp < now) {\n        let user = localStorage.getItem('user')\n        if (user == 'undefined' || user ==null) {\n          SetUser(accessInfo.user_id , accessInfo.token)\n        } \n        return true\n      }\n    } \n    return false\n}\n  \n  \nconst GetUser= function (){\n    let user = localStorage.getItem('user')\n    if(user!=='undefined' && user!=null){\n      return JSON.parse(user)\n    }\n    return null\n}\n  \nexport default{\n    state: {\n        logged: GetAccessInfo(),\n        currentUser: GetUser(),\n        users: [],\n    },\n    mutations: {\n        Register: async (state, payload) => {\n        let result = await users.RegisterUser(payload)\n        state.currentUser = result\n         localStorage.setItem('user', JSON.stringify(state.currentUser))\n         router.push('login')\n        },\n        Login: async (state, payload) => {\n          let result = await users.LoginUser(payload)\n          console.log(result)\n          localStorage.setItem('accessInfo', JSON.stringify(result))\n          state.logged=GetAccessInfo()\n          router.push('/')\n    \n        }\n      },\n      actions: {},\n      getters: {\n        getLogged: state => state.logged,\n        getCurrentUser: state => state.currentUser,\n        getStatus: state => state.status\n      },\n}"]},"metadata":{},"sourceType":"module"}